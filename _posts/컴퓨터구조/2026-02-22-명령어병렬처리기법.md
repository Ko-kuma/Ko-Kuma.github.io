---
layout: post
title: " 명령어 병렬 처리 기법"
date: 2026-02-22
categories: [Computer, Computer_Architecture]
tags: [Computer_Architecture, Pipelining, Hazard, Superscalar, OoOE]
---

빠른 CPU를 만들려면 높은 클럭 속도에 멀티코어, 멀티 스레드를 지원하는 CPU를 만드는 것도 중요하지만, CPU가 놀지 않고 시간을 알뜰하게 작동하게 만드는 것도 중요합니다. 이렇게 CPU를 쉬지 않고 작동시키는 기법인 명령어 병렬 처리 기법과 명령어 병렬 처리 기법의 명령어 파이프라이닝, 슈퍼스칼라, 비순차적 명령어 처리에 대해 알아봅시다.

## 1. 명령어 파이프라인 (Instruction Pipeline)

명령어 파이프라인을 이해하기 위해 하나의 명령어가 처리되는 전체 과정을 비슷한 시간 간격으로 나누어 보아야 합니다. 명령어 처리 과정을 클럭 단위로 나누어 보면 일반적으로 다음과 같이 나뉩니다.

* **명령어 인출 → 명령어 해석 → 명령어 실행 → 결과 저장**
* 또는 **명령어 인출 → 명령어 실행**
* 또는 **명령어 인출 → 명령어 해석 → 메모리 접근 → 결과 저장**

같은 단계가 겹치지만 않는다면 CPU는 각 단계를 동시에 실행할 수 있습니다. 공장의 생산 라인 같은 명령어들을 명령어 파이프라인에 넣고 동시에 처리하는 기법을 **명령어 파이프라이닝**이라고 합니다. 이는 동시에 여러 개의 명령어를 실행하는 기법입니다.



### 파이프라인 위험 (Pipeline Hazard)
파이프라이닝은 높은 성능을 가져오기는 하지만, 특정 상황에서는 성능 향상에 실패하는 경우도 있고 이러한 상황을 파이프라인 위험이라고 부릅니다. 파이프라인 위험은 크게 데이터 위험, 제어 위험, 구조적 위험으로 나누어집니다.

**1) 데이터 위험 (Data Hazard)**
데이터 위험은 명령어 간의 **데이터 의존성**에 의해 발생합니다.
* **데이터 의존성:** 어떤 명령어의 연산 결과가 다음 명령어의 입력값으로 사용되어야 하는 인과관계를 말합니다.
* 이전 명령어가 '결과 저장' 단계까지 끝나야만 다음 명령어가 그 데이터를 가져와 실행할 수 있는데, 파이프라인에 의해 너무 빨리 다음 명령어가 들어오면 아직 계산되지 않은 잘못된 데이터를 읽게 될 수 있습니다. 이 문제가 해결될 때까지 파이프라인은 일시 중단됩니다.

**2) 제어 위험 (Control Hazard)**
프로그램 카운터(PC)의 갑작스러운 변화에 의해 발생합니다. 주로 `JUMP`나 `IF` 같은 분기 명령어를 실행할 때, 다음에 실행할 주소가 바뀌면서 미리 파이프라인에 채워두었던 명령어들이 쓸모없어지는 현상입니다.
* **분기 예측 (Branch Prediction):** 제어 위험을 줄이기 위해 CPU가 어디로 분기할지 미리 추측하는 기술입니다. CPU가 "이 조건문은 아마 '참'일 것"이라고 예상하여 그 주소의 명령어를 미리 파이프라인에 채워 넣습니다. 예측이 맞으면 지연 없이 넘어가지만, 틀리면 파이프라인을 비우는 손해가 발생합니다.

**3) 구조적 위험 (Structural Hazard)**
서로 다른 명령어가 동시에 CPU 내부의 동일한 부품(ALU, 메모리 등)을 사용하려고 할 때 발생하는 **자원 위험**입니다.
* **비유:** 세탁기는 한 대인데 두 사람이 동시에 빨래를 하러 온 상황과 같습니다. 한 명은 빨래가 끝날 때까지 기다려야 하듯이, 특정 하드웨어 자원이 부족하여 명령어가 제때 처리되지 못하고 지연되는 상황을 뜻합니다.

---

## 2. 슈퍼스칼라 (Super-scalar)

명령어 파이프라인을 CPU 내부에 여러 개 두는 구조를 말합니다. 슈퍼스칼라 구조로 명령어 처리가 가능한 CPU를 **슈퍼스칼라 프로세서** 또는 **슈퍼스칼라 CPU**라고 합니다.
* 슈퍼스칼라는 파이프라인이 하나일 때보다 매 클럭마다 더 많은 명령어를 처리할 수 있습니다. 하지만 파이프라인 개수가 늘어날수록 명령어 간의 충돌이나 데이터 의존성을 관리하는 것이 훨씬 복잡해지므로 고도의 설계 능력이 필요합니다.



---

## 3. 비순차적 명령어 처리 (Out-of-Order Execution, OoOE)

파이프라인 중단을 방지하기 위해 명령어를 순차적으로 처리하지 않는 명령어 병렬 처리 기법입니다.
*  원래 프로그램에 적힌 순서대로만 명령어를 실행하면, 앞선 명령어가 데이터 위험 때문에 멈췄을 때 뒤에 있는 의존성 없는 명령어들까지 줄줄이 멈추게 됩니다.
* 이를 해결하기 위해 **의존성이 없는 명령어들을 먼저 실행**하여 CPU가 노는 시간을 최소화합니다. 실행은 순서를 바꿔서 하더라도 최종 결과물은 원래 프로그램 순서대로 저장하여 논리적 오류가 없도록 설계합니다.